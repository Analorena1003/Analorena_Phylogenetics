#Let's start by downloading a Staphylococcus aureus genome from NCBI using this command:

wget

#and let's make sure to unzip it so that we can access the .fna file directly (gunzip command). Make sure to use "head" and "tail" 

gunzip XXXXX
head XXXXX
tail XXXXX

#and

ls -lh

#Now let's get some basic stats using seqkit so we know what we're dealing with:

seqkit stats XXXXX.fna

#and

seqkit fx2tab -l -n -g XXXXXc.fna

#Predicting Protein-Coding Genes with Prodigal
#Now we can start predicting genes using Prodigal. The main page for this tool is here: https://github.com/hyattpd/Prodigal

#Prodigal is an excellent gene-prediction tool that works well for finding protein-coding genes. The paper that described this tool is quite readable and nicely describes some of the primary challenges of gene prediction Link to Prodigal paper!

#To install this tool you will probably be able to use Anaconda with the bioconda channel:

conda install prodigal -c bioconda

#Keep this general command format in mind- in future tutorials I won't explicitly put download instructions for tools unless they are atypical.

After installation, you can take a look at the help menu:

#prodigal -h

#Predicting rRNA genes with Barrnap
#So far we have only considered protein-coding genes, but genes that encode functional RNAs are very important and should be considered as well.

#To predict rRNAs and tRNAs we will use the tool barrnap: https://github.com/tseemann/barrnap

#To install barrnap we will use Anaconda, just as with prodigal:

conda install barrnap -c bioconda

#Barrnap is a relatively simple tool to use. We can see the help menu with

barrnap -h

#We essentially just need to give it the input FASTA file of the genome, and specify an output file with a ">" symbol.

barrnap XXXX_genomic.fna > XXX_rRNA.gff

#This gives us a GFF file with the coordinates of the predicted RNA genes, but it does not give us the sequences. To retrieve them we need to use a tool called BEDtools, which will cross reference the genome file with the GFF file and give us a FASTA file of all of the rRNA genes. More information on BEDtools can be found here: https://bedtools.readthedocs.io/en/latest/

#To install bedtools we can use the same conda command as we have been using:

conda install bedtools -c bioconda

#Bedtools is quite a versatile program, but here we only need to do something rather simple, so we will only use only one command:

bedtools getfasta -s -fi XXXXX_genomic.fna -bed XXXX_rRNA.gff -fo rRNA.fasta

#The rRNA.fasta file should have our rRNA genes. We need to supply the input sequence (-fi), the output file name (-fo), and the gff (-bed). The -s flag makes sure we retrieve sequences on the appropriate strand. Let's see how many we found:

seqkit stats XXXX_rRNA.fasta

seqkit fx2tab -n -l -g XXXX_rRNA.fasta

and let's say we wanted to get the sequence of the first 16S rRNA gene:

seqkit fx2tab XXXX_rRNA.fasta | grep "NZ_CP014429.1:512722-514271"

Retrieving the sequence of a 16S rRNA gene can be very helpful if you are unsure of the taxonomy of the genome that you are examining. These genes can be compared to various 16S databases to help identify a microbe.
